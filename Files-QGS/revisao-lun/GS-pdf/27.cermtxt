Sequential monitoring of SCADA systems
Sequential monitoring of SCADA systems
SSeeqquueennttiiaall mmoonniittoorriinngg ooff SSCCAADDAA ssyysstteemmss
Sequential monitoring of SCADA systems
against cyber/physical attacks
against cyber/physical attacks
aaggaaiinnsstt ccyybbeerr//pphhyyssiiccaall aattttaacckkss
against cyber/physical attacks
Van Long DO ∗ Lionel FILLATRE ∗∗ Igor NIKIFOROV ∗
Van Long DO ∗ Lionel FILLATRE ∗∗ Igor NIKIFOROV ∗
VVaann LLoonngg DDOO ∗∗ LLiioonneell FFIILLLLAATTRREE ∗∗∗∗ IIggoorr NNIIKKIIFFOORROOVV ∗∗
Van Long DO ∗ Lionel FILLATRE ∗∗ Igor NIKIFOROV ∗
∗∗ UUnnii1vv0eee00rrrsss0iii44tttyyy
∗ Univ0
1 0
10004 Troyes Cedexi,goFrr.annnniikkcceeiiffoo(((rreeeoo---vvmm@@aaauuiiillltt:::tt..vvffrraa))nn long.do@utt.fr and
1100000044 TTrrooyyeess CCeeddeexxi,,goFFrrr.aance m van lloonngg..ddoo@@uutttt..ffrr aanndd
∗ University of Technology of Troyes, CNRS, ICD/LM2S, UMR 6281,
∗ University of Technology of Troyes, CNRS, ICD/LM2S, UMR 6281,
TToorrffooyyTTeeeeessccchhhCCnneeoooddllleeoooxxggg,,yyy FFoorrffaaTTTnnccrrreeoooyyy((eeeeesss--,,,mmCCaaNNiill::RRvvSSSaa,,,nnII CCllooDDnn//gg..LLddMMoo@@222SSSuutt,,,tt..UUffrrMMaaRRnndd666222888111,,,
of T n of CNR ICD/LM UMR
∗∗ University Nice SophiiiggaoorrA..nnnnniiittkkiippiiifffoooollrriiooss,,vv@@CuuuNtttRttt...fffSrrr,))) I3S, UMR 7271, 06900
rov@
∗∗ University Nice SophiigaorA. k o CNRS, I3S, UMR 7271, 06900
∗∗∗∗∗∗ UUUSSnnnooiiippvvvhheeerrriiaasssiiitttAyyynnNNNttiiiiippcccooeeelliiSSSss,,ooopppFFhhhrraaiiiaaancAAAennn((ttteeiiippp--mooolllaaiiisssii,,,ll::CCClliiNNNoonnRRReeSSSll..,,,fifiIIIll333llaaSSStt,,,rreeUUU@@MMMii33RRRss..uu777nn222ii777cc111ee,,,..ff000rr))666999000000
A nce m
SSoopphhiiaa AAnnttiippoolliiss,, FFrraannccee ((ee--mmaaiill:: lliioonneell..fifillllaattrree@@ii33ss..uunniiccee..ffrr))
Sophia Antipolis, France (e-mail: lionel.fillatre@i3s.unice.fr)
Abstract: The sequential monitoring of SCADA systems against cyber/physical attacks is
Abstract: The sequential monitoring of SCADA systems against cyber/physical attacks is
Abstra The ue m
ccAAoobbnsssittdrreeaarrccceetttd::: inTThhtteehhiissssseeeppqqqaauuppeeeennnrrttt..iiiaaaTTlllhhmmee
nsid d in
oooSSnnnCiiitttAAooorrrDDiiinnnAggg ssooyyffssttSSeeCCmAAs DDaAAre sssddyyyeessssstttcceeerrmmiibbssedaaagggbbaaayiiinnnttssshhtttee cccddyyyiibbsscceeerrrrree///ttppeehh--ttyyyiisssmmiiiccceaaalllstaaaattttttteaaacccsskkkppsssaacciiieesss
of SCADA ms b ph
C A ms are ed y e state
cccmmooooonnnddsssiiieedddllsseeerrriieeenndddttiiihhnnnee tttpphhhrriiieessssseepppnnaaaccpppeeeeerrroo...ff TTTrraahhhnneeeddSSSooCCCmmAAAnnDDDooAAAiisseesssssyyy.. sssTTttteeehhmmmeesssccyyaaarrrbbeeeeerrddd//eeeppssshhcccyyrrriiissbbbiicceeeaadddll bbbaayyyttttaattthhhcckkeeessdddaaiiisssrrccceerrreeemmttteeeoo---ddttteeiiimmmlleeddeee sssaatttssaaatttaaeeeddddssspppiittaaaiivvccceeeee
dddppeeeaatttrreeeiittcccyytttiiiooossppnnnaacciiinnnee aassstttrroooeecccuuhhhttaaaiissslliitttzziiicccee---dddddyyyffoonnnrraaaggmmmeeiiinnccceeaaarrlllaasssttyyyiinnsssggttteeettmmmhhsssee... ssTTTeeqqhhhuueeeeennssstttcceeeeeaaadddooffyyy---rrssseetttssaaaiitttddeeeuuaaKKKllssaaa..lllmmmTThhaaannnee uufififinnllltttiieeefifirrreeddaaannnssttdddaatttttiihhhsstteeeiiccfififiaaxxxlleeemmddd---oosssddiiizzzeeeeell
ssmmeennoossddooeeerrllleeemdddeeaaaassssuuaarrddeedddmmiiittteiiivvvnneeett
mod as ad
m e
uuufifieeellttnnneetttrriiiaaaaalllnntttddrrraaannntthhsssiiieeeeennnfifitttxxccceehhhddaaa--ssnnniigggzzeeeee
is ooddddeeeevvll,,eeellltooohppeeeeVVdddaattrrooiiaa
iimss dev p
m the
to bbdddlleeeeessscccTrrrhhiiibbbrreeeeesshhttthhhooeeellddrrrWeeesssiiiiidddnnuuuddaaaolllwwgggLLeeennniimmeeerrriiaaatteetttddiiiooonnnCUbbbmyyyuubbblloooaattttthhhiivveemmmSSeeeUUttthhhMMoooddd((sssV... TTBBBWWaaasssLLeeedddCCUUooonnnSUttthhhMMiiisss) sssaatttllaaaggtttoiiirsssittttiiihcccmaaalll
T W o CUm V SU ) orithm
dduuueetttssiiilllcciiirrzzziieeebbddee fffoootthhrrreegggeeerrnneeeeessiirrrddaaauutttiiiaannnllgggggtteehhnneeeerrssaaeettqqiiuuoonneeennncccbbeeeyy
d n the sequ
ooobbfffortehsid a ified mo
orrteehssiiddmuuueeaattlllhhsss...ooddTTTsshhh.. eeeBBuuuannnsiiefifideeddoonnssstttaaatthhtttiiiiissssstttiiisscccttaaaaalllttmmiissttooiidddccaaeeelllll
m ased
iipppssaaarrrdiiieetttyyyvveesssllpppooppaaaccceeeeedd aaatrrroeee
d to
imms ooddddeeeeesslllii,,,ggttnnhheeeedd
mod the
is
iiiwwssshhdddiicceeehhsssiiigggaannniimmeeedddss tttaaooott dddmmeeetttiieeennccciimmttttttiizzhhhiieeennggtttrrrttaaahhnnneesssiiieeewwnnnootttrrssccctthhh--aaaccnnnaassgggeeeeessspp...rrTTTooaaabbkkkaaiiibbnnniiggglliittiiiyynnntttoooooff cccmmooonnniisssssssiiidddeeddeeerrraaaddttteeiiittoooeennncctttttiihhhoonneee dddssuueeetttbbeeejjccceetttcciiittooonnnttoocccrrraaiiittteeeggrrriiiiivvoooeennnnn,,,
VVVttaaaoorrriiiddaaaeebbbttllleeeeeccttTTThhhtthhrrreeeeessshhhttrroooaalllnndddssWWWiieenniiinnnttdddccooohhwwwaannLLLggiiieemmmss..iiitttTTeeedddaakkCCCiinnUUUggmmmiinnuuuttlllaaaootttiiiccvvvooeeennSSSssiiUUUddMMMeerraa(((ttVVViiooTTTnnWWWtthhLLLee CCCddUUUeettSSSeeUUUccttMMMiioonn))) aaacclllrrgggiiooottrrreeiiirrtttiihhhoonnmmm,,
99SttahhfeIIFFtyAAoCCf SSTyyemmchppnooicssaiiuulmmProonnceFFsaasuuellstt DDeetteeccttiioonn,, SSuuppeerrvviissiioonn aanndd
9StahfeIFtyAoCf STyemchpnoicsaiulmPronceFsasuelst Detection, Supervision and
SeafpetteymobfeTre2c-h4n,i2c0a1l5P.rAorctessesteMsétiers ParisTech, Paris, France
Available online at www.sciencedirect.com
SSaeaffpeettteyymoobffeTTree2cc-hh4nn,ii2cc0aa1ll5PP.rrAoorccteesssessteeMssétiers ParisTech, Paris, France
SSeepptteemmbbeerr 22--44,, 22001155.. AArrttss eett MMééttiieerrss PPaarriissTTeecchh,, PPaarriiss,, FFrraannccee
September 2-4, 2015. Arts et Métiers ParisTech, Paris, France
ScienceDirect
IFAC-PapersOnLine 48-21 (2015) 746-753
w s
vvwwaahhhlluuiiiccceehhh ooaaanniiimmmtthhssee
aaawwttt oommrrssiittnn--iiccmmaassiiieezzziiinnnppggrroobbttthhhaaeebiwlitoooyrrrsssootttff---cccffaaaasslleesseepppaarrrlloooaabbrraammbbb,iiilllttiiihhtttyyyee
minim g e w ase ba
biwlity ,
vvvVVaaaTTllluuuWWeee LLooonnnCCtttUUhhhSSeeeUUwwwMMooorrrsssaatttll---ggcccooaaarrsssiieeetthhpppmmrrrooo..bbbIIttaaabbbiissiiilllssiiittthhyyyoowwooofffnnfffttaaahhlllsssaaeeett aaatthhlllaaaeerrrmmmoopp,,,tttttiimmhhheeeaallttthhhcchhrrreeeoosssiihhhcceeooollloodddffsssttaaahhrrrrreeeeessttthhuuuoonnnllddeeedddss llfffeeoooaarrrddooossppptttttooiii mmmtthhiiizzzeeiiinnnssiigggmmtttpphhhlleeeee
ttooohhfffrrmmeessiiihhsssoossseeellddddss dddaaeeerrttteeeeecccttuutttiiinnoooeennddsfuoobbbrrjjjooeeecccpptttttiimttooiizzaaiinngggggiiivvvtteeehhnnnee
m d n ssfuu to a
m
FFVVViiTTTnnWWWiitteeLLLMMCCCooUUUvvSSSiinnUUUggMMMAAvvaaaeelllgggrroooaarrrggiiieettthhh((mmmFFMM...IIIAAtttiii))sss ddssshhheettoooeewwwccttnnniiootttnnhhhaaarrtttuutttlleehhh..eee TToooppphhttteeiiimmmpprraaaoolllppcccoohhhssoooeeiiiddccceeeaaooollggfffootttrrhhhiirrrtteeehhsssmmhhhooossllldddaasssrreellleeeaaaaappdddppssslltttiieeoooddttthhhttooeee sssddiiimmmeettpppeeccllleeett
ttFFFhhiiinnneeiiiccttteeeoovvMMeerrooottvvvaaiiinnnttttggaaccAAkkvvvooeeennrrraaaaagggeeesi((mmFFppMMlleeAASS))CdddAAeeetttDeeectiwwonnaattrrreeuuurrllleeedd...iissTTttrrhhiibbeeuupppttrrriiooooonnpppooonssseeeeettddwwaaaoolllrrgggkkooo..rrriiittthhhms are applied to detect
M g A (FMA) Accttiioon The d mmss aarree aapppplliieedd ttoo ddeetteecctt
si C DA n
tthhee ccoovveerrtt aattttaacckk oonn aa ssiimmppllee SSCCAADDAA wwaatteerr ddiissttrriibbuuttiioonn nneettwwoorrkk..
the covert attack on a simple SCADA water distribution network.
© 2015, IFAC (International Federation of Automatic Control) Hosting by Elsevier Ltd. All rights reserved.
ssmmmiiggooonndddaaeeelllllsssss iiioonnnff tttsshhhhheeeoorrpppttrrreeeddssseeeuunnnrraaccceeettiiooooonnfff rrriiaaammnnn
ppdddaaoooccmmmtteennnddoooiiibssseeeoossstt...hhTTTtthhhhheeeee cccssyyyttbbbaaeeettrrree///pppeehhhvvyyyoollsssuuiiicccttaaaiioolll nnaaatttaatttaaanncccdkkkssstthhaaaeerrreee
b d
eeeddqqqeeuuutteeaaacctttttiiiiiooooonnnnnsss...iinnTTThhhsseeettoodddcceeehhtttaaeeessccctttttiiiiiccooo--nnnddyyooonnfffaaaaammttttttiiaaacccccaakkkllsssssyyiiisssssttfffeeooommrrrmmmss..uuulllTTaaattthheeeeeddd ssaaattssseeaatttddhhhyyeee--pppssttrrraaooottbbbeellleeeKKmmmaallooommfffaassseeennqqq
ssseeiiiqqggguunnnaaaaattllliisssoonnooossfff.. TTssshhhhhoooeerrrtttddeedddtteeuuuccrrrttaaaiitttooiiinnooonnnooffiiimmmaattpppttaaaaaccccckkttteeessdddiiss bbbffooooorrtttmmhhhuutttllhhhaatteeeeeddssstttaaaaassttteeetthheeeeevvvppooolllrruuuootttbbiiilloooeennnmm aaaoonnnffdddsseeqqttthhhuueeeeennssstteeeiiaannnllsssooottrrrrraannmmmsseeeiieeaaannsssttuuurrrcceeehhmmmaanneeeggnnneettt
CCUUSSUUMM,, FFiinniittee MMoovviinngg AAvveerraaggee..
CUSUM, Finite Moving Average.
Keywords: SCADA systems, cyber attacks, transient change detection, Window Limited
Keywords: SCADA systems, cyber attacks, transient change detection, Window Limited
CKKKUUeeeyyySwwwUUoooMrrrddd,,sss:::FFSSSiinnCCCiittAAAeeDDDMMAAAoovvsssyyyiinnsssggttteeeAmmmvvsss,,,eerrcccaayyyggbbbeeeee..rrr aaattttttaaaccckkksss,,, tttrrraaannnsssiiieeennnttt ccchhhaaannngggeee dddeeettteeeccctttiiiooonnn,,, WWWiiinnndddooowww LLLiiimmmiiittteeeddd
C S M A
9th IFAC Symposium on Fault Detection, Supervision and
IIIcctttlloohhhssaaaeesssllyybbbeeerreeeeellnnnaattssseehhhddooowwwtonnn ttttthhhhhaaaeetttfftttaahhhuueeellttaaatttdttteeaaattccceekkkccttdddiieeeootttneeecccatttnniiioooddnnniiaaassoonnnlldddaattiiisssiiooooonnlllaaattt(iiiFoooDDnnnIIiiisss))
to d n a (F
eeaaattnnndddaallSSS..iii((nnn22ooo00ppp11ooo22lll))iii,,(((oo222rr000111tt000hh)))e,,, tttcchhhoovveeeeezzzrreeettrrroooaa---ttdddttaayyyccnnnkkaaa,,mmmssiiieeccceesss Saaamttttttiiaaattccchhkkk,,,((22ssseee00eee111TTT)eee.iiixxxeeeiiirrraaa
e Sm 1).
aaTTTllhhhssooeee ccpppoorrrnnooossbbbiiddllleeeeemmmrreeddooo..fff TTaaahhtttttteeaaaddccckkkeetteedddcceeetttttiieeeoocccnntttiiioooooffnnnccyyaaabbnnneedddrr iiiaasssttooottlllaaaaacctttkkiiiooossnnnoonnhhhaaappsssrroobbbcceeeeeeeessnnnss
More precisely, these weak points are exploited to design
More precisely, these weak points are exploited to design
ssMMMtteeoooaarrrlleeetthhpppyyrrreeeaacccttiiittsssaaeeecclllyyykk,,,sstttwwhhheeehhsssiieeecchhwwwcceeeaaaaannkkk pppppaaooorriiittnnniitttaasssllllaaayyrrrooeeerreeeccxxxoopppmllloooppiiitttlleeeeedddtteelltttyyooo bbdddyyeeeppsssiiiaagggssnnnss
m
caolsnotrccoooollnnnsssssiiiyydddsseettrreeeemmds. TThhhhaaeess
caaollssnootrco eredds.. The
dddbbeeeeettteeeeennccctttffiiiooooorrnnnmmooouufffllcccaayyytteebbbddeeerrriiaaannttttttCCaaaa´a´ccckkkrrddssseeooonnnnnaassppprrreeooottccceeeaasssllsss..
1. INTRODUCTION AND RELATED WORKS
1. INTRODUCTION AND RELATED WORKS
11.. IINNTTRROODDUUCCTTIIOONN AANNDD RREELLAATTEEDD WWOORRKKSS
1. INTRODUCTION AND RELATED WORKS
Supervisory Control and Data Acquisition (SCADA) sysSupervisory
Control and Data Acquisition (SCADA) sysSu
Co Acq (SCADA) sy
ttSSeeuummpppsseeerrrvvvhiiiaasssvvoooeerrryyy bbCCeeooeennnnntttrrruuooossllleeaaaddnnndddttooDDDaaacctttooaaannttAArrooccllqquuuaaiiinnsssiiiddtttiiiooomnnnoo((nnSSiiCCttooAArrDDaaAA))llaassrryyggsssee--h
m
tttnneeeuummmmmsssbbeehhhrraaavvvooeeeff ccbbbrriieeetteeeiinnnccaalluuuiisssnneeeffdddrraatttssooottrruucccccooottnnnuutttrrrrreeooosslll ssaaauunnnchddd aammmss oooeennnlleeiiitttccooottrrrrriiccaaa pplllooaaawwrrrgggeeeeerr
ch
ggnnnrruuuiimmmddssbbb,,eeettrrrrraaooonnfffsscccpprrrooiiitttrriiittcccaaaaattllliiooiiinnnnnfffrrrssaaayyssssstttttrrreeuuummccctttssuuu,,rrrcceeeoosssmmsssmmuuucccuuhhhnniiaaaccsssaatteeeiioollleeennccctttnnrrriiieecccttwwpppooooorrwwwkkeeessrrr,,
ttsssrrtttaaeeeaaaddllliittttthhiiooyynnaaaaatttlltttaaaanncccookkkmssswwaallhhhyyiiicccddhhheettcceeaaccnnttoopprrssaaa..rrrTtttiiiaaahhllleelllssyyyeeooouurrrnnccddooeemmtteepppccllltteeeaatttbeeelllleyyy aabbttyyttppaaccaaakkssssssss
hy w can p com byp
a m T ble
tttccrrraaaaanndddiiitttbbiiieeooonnnccaaalllllaaaaassnnnssiiooofifimmmedaaalllyyyiinndddtteeeoottteeettccchhtttoooeerrrsssrr...eeTTTppllhhhaaeeeyyssseeeaauuuttnnnttaadddcceeekkttt,,eeecccssttteeaaaeebbbllleeeMMaaaoottttttaaaacccnkkkddsss
ed an
cccSSaaaiinnnnooppbbooeellii ccc(lll2aaa00sss00sssiii99fififi))ee,,ddtthhiiieennntttffoooaallssttteehhheeeddaarrtteeaapppllliaaanyyyjecaaattttitttoaaanccckkkaa,,,ttttssaaeecceekk,,MMsseeooee aaaMMnnndddo
n be ed re see Mo
(2 injection o
aaSSSnniiinnndoooSSpppiiooonnlllooiiipp(((oo222ll000ii000((99922)))00,,,1100ttthhh)),,eeetthhfffaaaeelllzzssseeeeerrooddd--aaaddtttyyaaannaaiiinnnmmjjjeeeiiccccctttssiiiaaooottnnnttaaaaacctttkkttt,,aaassccceekkkee,,, TTssseeeeeiieeexxeeMMMiirraaooo
d
eett aall.. ((22001122)),, oorr tthhee ccoovveerrtt aattttaacckk,, sseeee SSmmiitthh ((22001111))..
et al. (2012), or the covert attack, see Smith (2011).
The problem of attack detection and isolation has been
The problem of attack detection and isolation has been
rrSSSooooooommmcchheeeyyeeexxxwwaaaaammmtteeppprrllleeebbsssrreeoooaafffccrrrhheee,,ccceeesseennneettt SScccyyyllaabbbyyeeerrraanniiinnnddccciiiMMdddeeeiillnnnlleetttsssrr ((iiinnn22ccc00lll00uuu77ddd))eee,, ttttthhhhheeeee UUMMM..SSaaa---..
rrreeooolleeoooccccctthhhrriiyyycciiwwwttyyaaatttggeeerrrrriiddbbbrrreeeppaaaecccnhhhee,,,ttrrsssaaeeeeeettiiooSSSnnlllaaa,,yyysseeaaaeennndddGGMMMoorriiimmlllllleeeaarrrnn(((222((000220000077700)))99,,,)),,ttthhhooeeerrUUUt...hSSSee...
en th
SSttuuxxnneett vviirruuss,, sseeee BBrruunnnneerr eett aall.. ((22001100))..
Stuxnet virus, see Brunner et al. (2010).
eeeSSllltteeeuucccxxtttrrrnniiieecccttiiitttyyyvviirrggguurrrssiii,,dddsseepppeeeeennnBBeeerrtttuurrrnnaaanntttiiieeooorrnnnee,,,ttsssaaeeeeeell.. ((GGG22ooo00rrr11mmm00))aaa..nnn (((222000000999))),,, ooorrr ttthhheee
ooTTTffwwwSSoooCCaaaAAppppppDDrrrAAoooaaasscccyyhhhsseeettssseehhhmmaaasvvveeeagbbbaaeeeiieeennnnnssttcccoooccnnnyysssbiiidddeerreee//rrrppeeedddhhyytttssoooiiccsssaatttuuulldddaayyytttttttaahhhcceeekksssss::eeeccciiuuunnrrrffooiiitttrryyy-s
ag b
Two approaches have been considered to study the security
Two approaches have been considered to study the security
ttgggeeeeemmooogggssrrrbbaaapppeecchhhooiiicccmmaaaeellllllyyymmdddooiiirrssseepppaaeeennrrrsssddeeedddmmooccchhhrreeaaarrrssaaauucccsstttcceeeeerrrppiiissstttttiibbiiicccllsssee,,, tttttoohhhcceeeyySSbbCCeerrAA//ppDDhhAAyyssssiiyyccaasss---ll
SCADA sy
tttaaeeettmmmttaassscckkbbbsseee,,cccnnooommmootteeeoommmnnlloooyyrrreeeooaaannnnnttdddhhmmmeeppooorrrhheeeyysssssuuuiiccsssaaccclleeepppiinntttffiiirrbbbaallleeesstttttrrooouucccccttyyyuubbbrreeeeerrrss///bbpppuuhhhttyyysssaaiiicccllssaaaoolll
aaaootttnntttaaattccchhkkkeesss,,, ccnnnooooommtttmmooouunnnnnlllyyyiiccoooaannnttiiootttnnhhheeennpppeehhhttwwyyysssooiiirrccckkaaalll aaiiinnnnnddfffrrraaattssshhtttrrreeuuuccccctttoouuunnrrrtteeerrsssoollbbbuuucceetttnnaaattllleesssrrooo..
oooSnnnommttteehhheeeeexxcccaaooommmmmppmmmlleeuuussnnnooiiicccffaaarrttteeiiiccoooeennnnnttnnneeecctttyywwwbboooeerrrrrkkkiinnaaaccnnniidddddeennttttthhhsseeeiinncccccooollnnnuutttdrrreeooolllthccceeeeennnMMttteeeaarrr--...
So d th
gggggrrraaiiissdddppsss,,,iippttteerrrllaaaiinnnnneessssspppaaooonnrrrtttddaaatttwwiiioooaannntteerrsssyyyddsssiitttsseeettrrmmmiibbsssuu,,,ttccciiooooonnmmmnnmmmeeuuuttwwnnniiioocccrraaakktttssiii..ooonnnDDuunnneeeeetttttoowwwoootthhrrrkkkeesssiirr,,,
gggggeeaaaoosssggppprriiiaapppppeeehhllliiiiinnncceeeaasssllllaaayynnndddddiisswwwppaaaeetttrreeessrrreedddddiiiccssshhtttrrraaiiirrbbbaauuucctttttiiieeooorrnnniissnnnttiieeecctttsswww,, ooottrrrhhkkkeesss...SSDDDCCuuuAAeeeDDtttoooAAttthhhssyyeeessiiirrr-cooyvvveeebbrrre,,,r
coy
er
ttmiivveeeeentsssiiieegggqqnnnuaaallss
to b
tiv uaalsttiittoooonnssbb..
m nt
ooommfffaaSSSttiiCCCooAAAnnDDDsseeAAAccuusssrryyyiittsssyyttteeemmmaappsssppaaarroogggaaaaacciiinnnhhssstttaanncccddyyybbbsseeeeerrrcc///uuppprrhhheeyyyccsssiiioocccnnaaattlllrrooaaallttttttttaaahhccceekkkoosssrr:::yyiiinnnoofffnnooorrree---,,
iimmmnnaaaKKtttiiiwwooonnnoonnssseeeeecccttuuurrraaiiillttt..yyy((22aaa00ppp11ppp33rrr))ooo..aaaTTccchhhhheeaaa nnniinndddffoosssrreeemmcccuuuaarrrtteeeiioocccnnooonnnsseetttccrrruuooolllrriittttthhhyyeeemmooorrreeyyytthhooooonnnddeeess,,,
iiiccnnnoonnKKcceewwnnoottnnrraaeeetttttee aaammlll...aa(((iinn222ll0y1
Kwon 01
0y1333o)))n...
on
TTTtthhhhheeeee aaiiinnnuufffttooohhrrreemmmnnttaaaiitttcciiiaaooottnnniioosssnneee,,cccuuuaarrrcciiiccttteeyyyssssmmmcceeeootttnnhhhttooorrdddoosssll
((ccc22ooo00nnn11tttrrr11ooo))lllaasssssyyyttssshhttteeeee mmmffaasssuullhhhttaaaddsssiiaabbbggeeenneeeoonnnssiissfffooopprrrrrmmmoouuubblllllaaaeetttmmeeeddd..TTiiihhnnneeCCCnn´a´a´aoorrrnnddd--eeeppnnnaaaaarraasssmmeeeeetttttrraaaiilllcc...
(((CC222UU000111SS111UU)))MMaaasssaatttllhhhggeeeoorrfffiiaaattuuuhhlllmmtttdddiiiiissaaauugggnnnttiiooolliissszziiieesssddppprrrttooooobbbddllleeeeemmmttee...ccttTTTtthhhhheeeeennnaaooottnnntt---aapppccaaakkrrrssaaa.. mmmMMeeeootttrrrrreeiiiccc-ooCCCvvUUUeerrSSS,,UUUttMMMhheeaaalllssgggeeoooccrrruuiiitttrrhhhiittmmmyy
iiioosssff uuuwwtttiiiaallliiittzzzeeeeerrddd iitttrrooorriidddggeeeaattttteeeiioocccnnttt ttthhhnneeeeettaaawwtttootttaaarrkkccckkksssss...aaggMMMaaoooiinnrrrsseeett--aattthhhtttteeeaaccssskkeeesscccuuuhhrrraaiiisstttyyybbeeoooeefffnn
ccwwwooaaanntttsseeeiirrrddeeiiirrrrreerrrddiiigggiiaaanntttiiiAAooonnnmmiinnnnneeeeetttttwwwaaooollrrr..kkk((sss2200aaa11ggg22aaaaaiii,,nnnbbsss))ttt,,
ccwwyyhbbeeerrreaaaaattttttbbaaacccaakkknnssskkhhhooaaaffsss
cyber
here
uubbbnneeeeeekknnnnnoocccwwooonnnnnsssiiiiidddnneeepprrruueeettddd ooiiinnnbbssAAAeemmmrrvviiieennnrrsseeetttiissaaallldd...ee(((ss222ii000gg111nn222eeaaadd,,,bbbtt)))oo,,,
ddwwweehhhtteeeeerrrcceeett aaaaannbbbddaaannniikkkssoolloooaaffftteeuuunnnttkkkhhnnneeooowwwaattnnnttaaiiiccnnnkkpppssuuu..tttFFoooiinnbbbaassseeellllrrryyvvv,,eeeaarrrsss cciiioosssmmdddppeeesssrriiieeggghhnnneeeeenndddssiivvtttoooee
fddreeeatttmmeeeccceetttwwaaoonnrrkkdd hhiiiaasssooosslllbbaaaeettteeeeennttiihhnneettrraaaootttdtttuuaaaccccckkkeeddsss...iinnFFFiiiPnnnaaaaasslllqqlllyyyu,,,aaaalleettccttooiimmeettpppaarrreeell..hh((ee22nnn0sss1iiivvv33eee))
d and the a com he
fra d P u 01
fffttrrrooaaammmsstteeeuuwwwddyyooorrrttkkkhhhhheeaaaaasssttbbbttaaeeeeeecckknnn iiiddnnneetttttrrreeoooccdddttuuuiioocccnneeedddaaiiinnnnnddPPPiiaaaddssseeqqqnnuuuttaaaiififillleeecctttaatttttiiiiiooeeennttt aaapplll...rroo(((222bb000llee111mm333)))..
tttTooohhssseetttdduuueedddttyyyeerrtttmmhhheeeiinnaaaiissttttttttiiaaacccccsskkkttaadddtteeeeettteeesscccpptttaaiiiccoooeennn maaannnoddddeiiildddiieeessnnnuutttiiittfififiiillccciizzaaaeetttddiiiooonnnttoopppddrrreeooossbbbcclllrreeeiimmmbbee...
T model
SSTTTCChhheeeAAdddDDeeeAAttteeessrrryymmmssiiittnnneeiiimmssstttssiii..ccc TTsssttthhaaaeettteeeccyyssspppbbaaaeecccrreeeaammmttttoooaadddcckkeeesslll iiiaasssrruuueetttmmiiillliiioozzzddeeedddeelleetttddooo dddaaeeesssssaacccddrrriiiddbbbiieee-ttSSiiCCvveeAADDssiiggAAnnaassyyllsssssttttteeeoommbbsss...oottTThhhhheeessttccaayytteebbbeeeeerrrvvaaaootttlluutttaaattiicccookkknnsss
aaaaarrrnneeeddmmsseeoonnddsseeeoollleeerrdddmmaaaeesssaaaassdduudddrreeiii----SCADA
sy m T cy mod ad
studying the vulnerabilities of networked control systems.
This work received financial support from the French National
This work received financial support from the French National
ReTTsehhaiirsschwwooArrgkkenrreecccyeeii(vvAeeNddRfifi)nn.aanncciiaall ssuuppppoorrtt ffrroomm tthhee FFrreenncchh NNaattiioonnaall
ReTsehairschwoArgkenreccyei(vAeNdRfi)n.ancial support from the French National
IIIssnnnttuuddrrreeeyyccciieeennnnnggtttttyyyhheeeeeaaavvrrrsssuu,,,llnnaaaeerrgggaarrrbbeeeiiaaalliitttttiidddeesseeeaaaoolllff ooonnfffeetteeewwffffffooooorrrrrkkttteehhhddaaaccsssoonnbbbtteeerreeeoonnnll sspppyyaaassiiittdddeemmfffooossrrr..
ssttuuddyyiinngg tthhee vvuullnneerraabbiilliittiieess ooff nneettwwoorrkkeedd ccoonnttrrooll ssyysstteemmss..
cccooooorrnnnmmccceeeeennnsssstttaarrraaaggttteeeeeiinnmmmtteeaaaggiiinnnrriilllttyyyyy..oooOOnnnnnttttthhhhheeeeeaaaoouuuttttthhhhheeeeerrnnnhhtttaaiiicccnnaaaddttt,,iiiooottnnnhh,,,ee aaassccceeccccceeeuusssrrsssee cccccooooonnnnntttttrrrrrooooolllll
CCPooepperyyriieggvhhiettw©©u22n00d11e55r rIIFFeAAspCConsibility of International Federation of Automa77t44ic66Control.
RReesseeaarrcchh AAggeennccyy ((AANNRR))..
Research Agency (ANR).
Copyright © 2015 IFAC
10.1016/j.ifacol.2015.09.616
Copyright © 2015 IFAC
C2o40p5y-r8i9g6h3t © 201155, IIFFAACC (International Federation of Automatic Contr7o4l)6Hosting by Elsevier Ltd. All rights reserved.
746
746
SSCCAADDAA ssyysstteemmss ttoo ddeetteecctt tthhee aattttaacckkss..
SCADA systems to detect the attacks.
In recent years, a great deal of effort has been paid for
In recent years, a great deal of effort has been paid for
ttooohhrrreemmmoorreeeyyssssssaaaaappgggppeeerriiioonnnaatttcceeehhgggrrreeiiitttxxyyypp... llOOOooiinnnttssttttthhhhheeeeeoooaattthhhnneeeaarrrllyyhhhttaaaiiccnnnaadddll,,,rrttteehhhddeeeuusssnneeeddcccaauuunnrrrcceeeyycccooooonnnfftttttrrrhhoooeelll
tttSShhhCeeeAAooorrrDDyyyAaaapppsspppyyrrrssoootteeaaammccchhhs eeettxxxoopppddllloooeeiiittttteesssccttttthhhteeeheaaannnaaaaattlllttyyyaatttcciiikkcccssaaa..lll rrreeeddduuunnndddaaannncccyyy ooofff ttthhheee
C A s the
aammmrreeeeennnpptttrrooeeeppqqquuuoossaaaeetttddiiiooonnnttoosss...ddCCCeetteeeeennncctttttrrraaaaalllnniiizzzddeeedddiiddeeaaannnnnttdddiiffyydddttiiissshhttteerrriiiaabbbttuuutttttaaeeeccdddkkssaaa..lllgggooorrriiittthhhmmmsss
oooCCttthhheennssstttttrraaaaatttlleeeiizzeeeeeddvvvoooaallluuuntttddiiiooonnnddiissaaattnnnrrdddiibbuussseeettnnneeddsssooorrralmmmgooeeerraaaiittssshhuuumrrreeess--n
alg m
aarree pprrooppoosseedd ttoo ddeetteecctt aanndd iiddeennttiiffyy tthhee aattttaacckkss..
are proposed to detect and identify the attacks.
It has been shown that the attack detection and isolation is
It has been shown that the attack detection and isolation is
cccplllroooosssbbeeellllleeyyymmrrr..eeelllTTaaatttheeeiddds tttpooorotttbbhhhlleeeee mmfffaaauuuislllttt gdddeeeenttteeeeerrcccaatttlliiilloooyynnn ssaaaoonnnllvvdddee diiisssoooblllaaayytttiiiuuooossnnniinn(((ggFFF DDDtthhIIIee)))
pro his pro is gen d b
aapppnnrrroooaabbbllyyllleeettmmmiicc aa...llTTTrrhhheeiiiddsssuupppnnrrrddoooaabbbnnlllcceeeyymmm aaiiippsssppgggrreeeoonnnaaeeecchhrrraaa,,llllllwwyyyhhsssiiooocclllhhvvveeeccdddoonnbbbssyyyiissttuuusssssiiinnnooffggg tttttwwhhhooeee
aannaallyyttiiccaall rreedduunnddaannccyy aapppprrooaacchh,, wwhhiicchh ccoonnssiissttss ooff ttwwoo
analytical redundancy approach, which consists of two
SAFEPROCESS 2015
September 2-4, 2015. Paris, France
Van Long DO et al. / IFAC-PapersOnLine 48-21 (2015) 746-753
747
steps: residual generation and residual evaluation. The
residuals are first generated by using traditional methods
(i.e., the Kalman filter or the parity space approaches)
and they are then evaluated by utilizing change detection
techniques (see, among others, Basseville and Nikiforov
(1993); Chen and Patton (1999)).
2. CONTRIBUTION AND ORGANISATION
Usually, a cyber/physical attack comes in unexpected
time and unexpected situation. The attacker may prefer
to perform his malevolent action within a short period
due to the resource limit. Hence, the changes produced
by the malicious attack in the SCADA system arrive
suddenly and their duration is usually short. From the
other hand, for safety-critical applications, it is required to
detect the attacks with the detection delay upper bounded
by a certain prescribed value. For these reasons, it is
more adequate to formulate the detection of attacks as
the sequential detection of a short signal (also called a
transient change) in a stochastic-dynamical system.
The change detection problem, including the traditional
abrupt change detection and the transient change detection,
consists in calculating the stopping time T at which
the changes produced at change-point k0 are detected. In
the traditional abrupt change detection, the post-change
period is assumed to be infinitely long (see for details the
recent survey of Lai (2001) and also recent books Poor and
Hadjiliadis (2009); Tartakovsky et al. (2014)). Typically,
the criterion of optimality aims at minimizing the average
detection delay for a given average run length to a false
alarm. Unfortunately, such an optimality criterion is not
adequate for the transient change detection problem which
deals with the changes of short duration. The delayed (or
latent) detection of changes after their disappearance is
considered as missed.
The mathematical formulation of the transient change detection
problem for the independent observation model has
been considered in Gu´epi´e et al. (2012a,b); Gu´epi´e (2013).
The optimality criterion involves the minimization of the
worst-case probability of missed detection for a given value
on the worst-case probability of false alarm within any
time window of chosen length. A sub-optimal algorithm
with respect to (w.r.t.) this criterion has been introduced
for the case of independent normal observations.
This paper, pursuing the work started in Gu´epi´e et al.
(2012a,b); Gu´epi´e (2013), is dedicated to the detection
of cyber/physical attacks on SCADA systems described
by the discrete-time state space model in the presence of
unknown system states and random noises.
The contribution of this paper is threefold. First, we introduce
a unified statistical model of the residuals generated
by either the steady-state Kalman filter approach or the
fixed-size parity space approach applicable to the system
with transient changes. Second, we design a sub-optimal
algorithm (for both the Kalman filter-based approach
and the parity space-based approach) to detect transient
changes in discrete-time state space models. Finally, we
apply the proposed algorithms to the detection of cyber/physical
attacks on a simple SCADA system.
747
The originality of this paper w.r.t. Gu´epi´e et al. (2012a,b);
Gu´epi´e (2013) is a more sophisticated model of observations.
The design and the study of the transient change
detectors in these previous papers depend heavily on the
concept of associated random variables, see details and
results in Lehmann (1966); Esary et al. (1967). Unfortunately,
it is impossible to use again this concept due to
the fact that the observations are generated by the state
space model in the presence of unknown system states
(nuisances) and random noises. For this reason, another
method of the design and the study of the detector is used
now.
The structure of the paper is organized as following. The
problem statement and the unified statistical model are
given in section 3 and section 4, respectively. Based on
the unified statistical model, the VTWL CUSUM and
FMA tests are designed in section 5. The application of
the proposed algorithms to the detection of attack on the
water network is presented in section 6. Some concluding
remarks are drawn in section 7.
3. PROBLEM STATEMENT
In this paper, we utilize the following discrete-time
state space model to describe SCADA systems and cyber/physical
attacks:
xk+1 = Axk + Buk + F dk + Baak + wk
yk
= Cxk + Duk + Gdk + Daak + vk
; x0 = x0,
(1)
where xk ∈ Rn is the vector of system states with unknown
initial condition x0, uk ∈ Rm is the vector of control
signals, dk ∈ Rq is the vector of disturbances, yk ∈ Rp
is the vector of measurements, ak ∈ Rs is the vector of
attack signals, wk ∈ Rn is the vector of process noises
and vk ∈ Rp is the vector of sensor noises; the matrices
A ∈ Rn×n, B ∈ Rn×m, F ∈ Rn×q, C ∈ Rp×n, D ∈ Rp×m,
G ∈ Rp×q, Ba ∈ Rn×s and Da ∈ Rp×s are assumed to be
known.
For simplicity, let us suppose that the control signals uk
and the disturbances dk are completely known. The control
signals are the outputs of controllers so they are generally
known to system operators. For safety-critical applications
such as electric power grids, gas pipelines or water distribution
networks, the disturbances dk correspond to customer
demands which are often estimated by special-designed
software with an acceptable level of errors. Generally, these
estimation errors are unbiased, so they can be integrated
into the process noises wk and/or the sensor noises vk.
The process noises wk ∼ N (0, Q) and the sensor noises
vk ∼ N (0, R) are assumed to be independent identically
distributed (i.i.d.) zero-mean Gaussian random vectors,
where the covariance matrices Q ∈ Rn×n and R ∈ Rp×p
are exactly known and R is positive definite.
Let us suppose that the attacker performs his malicious
action during a short period τa = [k0, k0 + L − 1], where
k0 is the unknown attack instant and L is the known
change period. The attack vector ak is then described as
follows:
SAFEPROCESS 2015
7S4e8ptember 2-4, 2015. Paris, France
Van Long DO et al. / IFAC-PapersOnLine 48-21 (2015) 746-753
0

if k < k0
(2)
ak =
θk−k0+1 if k0 ≤ k < k0 + L ,
0
if k ≥ k0 + L
where θ1, θ2, · · · , θL ∈ Rs are the attack profiles, which are
assumed to be completely known.
Remark 1. It has been shown in Mo and Sinopoli (2009);
Mo et al. (2010); Smith (2011); Teixeira et al. (2012)
that the attack vector ak can be designed to disrupt the
systems while bypassing traditional anomaly detectors.
The security analysis process is required to render such
attacks detectable. For example, more secure sensors may
be equipped in vulnerable points of the systems, making
these stealthy attacks detectable (see, for example, Mo
and Sinopoli (2010), Teixeira et al. (2012) or Kwon et al.
(2013)). For these reasons, we consider the detection of
only detectable attacks.
Remark 2. In this paper, the vectors θ1, θ2, · · · , θL are
assumed to be exactly known. These vectors are defined
by the dynamics of equipment and by the type of attack.
For some water distribution systems, the dynamics of
equipment (pumps, compressors, etc.) is a priori known
or can be pre-calculated. It also can be assumed that each
attack scenario leads to a particular attack signature.
Let us consider a simple SCADA water distribution network
presented in Fig. 1 in section 6, where a pump is
utilized for supplying water to a reservoir. It is assumed
that the water distribution system is equipped with a
constant speed pump. Such a pump operates in two modes:
“on” and “off”. It is assumed that the attacker performs
his malicious attack for switching the pump “off” while
it is functioning (see Zetter (2011) for a real attack on a
water utility). In this case, the vectors θ1, θ2, · · · , θL are
completely specified.
In this paper, we use the transient detection criterion
which was first introduced in Gu´epi´e et al. (2012b); Gu´epi´e
(2013). We wish to minimize the following worst-case
probability of missed detection
inf
T ∈Cα
Pmd (T ; L) = sup Pk0 (T − k0 + 1 > L T ≥ k0) ,
|
k0≥L
among all stopping times T ∈ Cα satisfying
Cα =
T : Pfa (T ; mα) = sup P0 {l ≤ T < l + mα} ≤ α ,
l≥L
(4)
where Pmd denotes the worst-case probability of missed
detection and Pfa stands for the worst-case probability of
false alarm within any time window of length mα.
4. UNIFIED STATISTICAL MODELS
In this section, the unified statistical model of the residuals
generated by both the steady-state Kalman filter approach
and the fixed-size parity space approach is developed.
4.1 Steady-state Kalman filter
Let us suppose that the steady-state Kalman filter is used
for generating the sequence of residuals. The steady-state
Kalman gain is calculated as
K = P CT
CP CT + R −1 ,
(3)
(5)
748
where P denotes the steady-state covariance matrix of the
state estimation error, which can be found by solving the
following discrete-time algebraic Riccati equation:
P = AP AT − AP CT
CP CT + R −1 CP AT + Q. (6)
The operation of the steady-state Kalman filter is then
described by the following equation:
xˆk+1|k
yˆk|k−1
= Cxˆk|k−1 + Duk + Gdk
= Axˆk|k−1 + Buk + F dk + AK yk − yˆk|k−1 ,
k ∼ N
(7)
where xˆk|k−1 ∈ Rn is state estimate with initial condition
xˆ0|−1 = x0, and yˆk|k−1 ∈ Rp is the output estimate.
Let rk = yk − yˆk|k−1 ∈ Rp be the residuals (or the
innovations). The innovations {rk}k≥0 have been shown
to be independent Gaussian random variables with the
covariance matrix CP CT + R. Let 0, 1, · · · , k ∈ Rp
be i.i.d. zero-mean Gaussian random vectors satisfying
0, CP CT + R .
The model of the innovations is then expressed by
 k

ψ˜k + k
if k < k0
if k ≥ k0 + L
rk =
ψk−k0+1 + k if k0 ≤ k < k0 + L ,
(8)
where the transient change profiles (or innovation signatures)
ψ1, ψ2, · · · , ψL ∈ Rp are calculated by
k+1 = (A − AKC) k + (Ba − AKDa) θk
ψk
= C k + Daθk
; 1 = 0,
(9)
and the post-change profiles ψ˜k (i.e., for k ≥ k0 + L) are
of no interest. The interested readers can find additional
details on the calculation of innovation signatures in Basseville
and Nikiforov (1993); Lai and Shan (1999).
Let rkk−L+1 = rkT−L+1, · · · , rkT T ∈ RLp be the vector of
residuals, kk−L+1 = kT−L+1, · · · , kT ∈ RLp be the vector
of random noises, and ψk
k−L+1 (k0) ∈ RLp be the vector of
transient signals. The vector ψk
k−L+1 (k0) depends on the
relative position of the change-point k0 within the window
[k − L + 1, k] by the following relation:
[0] if k < k0
 0 

ψkk−L+1 (k0) =  ψ...1  if k0 ≤ k < k0 + L , (10)
 ψk−k0+1
ψ˜k
k−L+1 (k0) if k ≥ L
where the vector of post-change profiles ψ˜k
k−L+1 (k0) ∈
RLp are of no interest. Putting together with (8)-(10), the
statistical model of the residual vector rkk−L+1 generated
by the steady-state Kalman filter is described as
rkk−L+1 = ψkk−L+1 (k0) + kk−L+1, (11)
k
where the random noises N (0, Σ ), where
Σ = diag CP CT + R ∈ RLkp−×LL+p1is∼the diagonal matrix
formed of L blocks of CP CT + R.
4.2 Fixed-size parity space
By eliminating the control signals uk and the disturbances
dk (since they are assumed to be known), we obtain the
SAFEPROCESS 2015
September 2-4, 2015. Paris, France
Van Long DO et al. / IFAC-PapersOnLine 48-21 (2015) 746-753
749
following simplified observation model:
 zk−L+1 
 zk−L+2  = 
 ...  
zk

C
CA
.
.
.
CAL−1

 vk−L+1 
 xk−L+1 +  vk−L+2  +
.
  .. 
vk
zkk−L+1




Da
CBa
.
.
.
CAL−2Ba CAL−3Ba · · · Da
C
0
Da
.
.
.
M
vkk−L+1
· · · 0   ak−L+1 
· · · 0
. . . ...   
ak−L+2  +
.
.
.
ak
θkk−L+1(k0)




0 0
C 0
... ...
CAL−2 CAL−3 · · · 0
· · · 0   wk−L+1 
· · · 0
. . . ...  
wk−L+2 
... , (12)
wk
H
wkk−L+1
where zkk−L+1 ∈ RLp is the vector of simplified observations,
wk
k−L+1 ∈ RLn is the vector of process noises,
vkk−L+1 ∈ RLp is the vector of sensor noises, θkk−L+1 (k0) ∈
RLs is the vector of transient signals; the matrices C ∈
RLp×n, H ∈ RLp×Ln and M ∈ RLp×Ls. The process
noises wkk−L+1 ∼ N (0, Q) and the sensor noises
vkk−L+1 ∼ N (0, R), where Q = diag (Q) ∈ RLn×Ln and
R = diag (R) ∈ RLp×Lp. The vector of attack profiles
θkk−L+1 (k0), depending on the relative position of the
change-point k0 within the window [k − L + 1, k], is described
as
k
θk−L+1 (k0) =
[0]
 [0] 

 θ...1 
 θk−k0+1

 ˜k
 θk−L+1 (k0)
if k < k0
if k0 ≤ k < k0 + L ,
if k ≥ k0 + L
(13)
where the post-change profiles θ˜k
k−L+1 (k0) ∈ RLs are of
no interest. The observation model is then described as
zk−L+1 = Cxk−L+1 +Mθk−L+1 (k0)+Hwkk−L+1 + vk−L+1.
k k k
(14)
The rejection of the nuisance parameter has been discussed
in Fouladirad and Nikiforov (2005) by applying the invariant
theory. The main idea is as follows. The observation
vector zkk−L+1 is projected onto the orthogonal complement
space R (C)⊥ of the column space R (C) of matrix C,
which is assumed to be full column rank. The residual
vector is calculated as rkk−L+1 = Wzkk−L+1, where the
columns of the matrix WT ∈ RLp×(Lp−n) are composed
of the eigenvectors of the projection matrix PC = I C
CT C −1 CT corresponding to eigenvalue 1. The matrix
W satisfies the following conditions: WC = 0, WT W = PC
and WWT = I. It is clear that the residual vector rkk−L+1
is independent from the nuisance vector xk−L+1.
749
Let ϕkk−L+1 (k0) = WMθkk−L+1 (k0) be the vector of
transient signals and ςkk−L+1 = W Hwkk−L+1 + vkk−L+1
be the vector of random noises. The statistical model of the
residual vector rkk−L+1 generated by the fixed-size parity
space approach is described as
rkk−L+1 = ϕkk−L+1 (k0) + ςkk−L+1, (15)
k
where the random noises ςk−L+1 ∼ N (0, Σς ), where the
covariance matrix Σς = W HQHT + R WT .
Remark 3. Taking into account the information about the
noise covariances, Gustafsson (2002) suggested to replace
the unknown system state xk−L+1 by its least-square
estimate xˆk−L+1. The residual generator by the leastsquare
estimation method is described as
rkk−L+1 = WLS zkk−L+1, (16)
where the rows of the rejection matrix WLS ∈ R(Lp−n)×Lp
form the basis for the row space of the projection matrix
PLS = I − C CT S−1C −1 CT S−1,
where S = HQHT + R and the projection matrix PLS is
of rank Lp − n, idempotent but not necessarily symmetric.
It can be seen from (16) that the least-square estimation
method offers the residuals with the same structure as the
fixed-size parity space approach does. The main difference
between the two methods is the calculation of the rejection
matrices W and WLS . The rejection matrix W calculated
by the fixed-size parity space approach is independent
of the noise covariances while the computation of WLS
requires the information about noise covariance matrices
R and Q. It has been discussed in Gustafsson (2002) that
the least-square estimation method offers the residuals
with minimum covariance. However, the residuals with
minimum covariance do not guarantee the statistical performance
of a detection procedure since small noise covariance
is often associated with small value of the change
magnitude (due to the projection).
An analogous problem of optimal fault detection has been
addressed within the statistical framework in Fouladirad
et al. (2008). A linear model with nuisance parameters
and a general covariance matrix (not necessarily diagonal)
has been considered in the context of the unknown but
non-random nuisance parameters. Two different invariant
tests have been designed in such a case. The first invariant
statistics was based on the knowledge of the observation
matrix and the noise covariance matrix and the second
one was based on the observation matrix only. It was
shown that these methods are equivalent. The comparison
between residual-generation methods will be performed
by means of the Kullback-Leibler distance in the next
subsection and some results of numerical simulation are
available in section 6.
4.3 Unified statistical model
It follows from (11) and (15) that the utilization of the
steady-state Kalman filter and the fixed-size parity space
leads to the following unified statistical model:
rkk−L+1 = φkk−L+1 (k0) + ξkk−L+1, (17)
where rkk−L+1 is the vector of residuals, φk
k−L+1 (k0) is the
k
vector of transient signals and ξk−L+1 ∼ N (0, Σ) is the
vector of random noises.
SAFEPROCESS 2015
7S5e0ptember 2-4, 2015. Paris, France
Van Long DO et al. / IFAC-PapersOnLine 48-21 (2015) 746-753
Remark 4. If the steady-state Kalman filter approach is
used, the transient profiles φkk−L+1 (k0) = ψkk−L+1 (k0)
and the random noises ξkk−L+1 = kk−L+1 (i.e., Σ = Σ ).
On the other hand, if the fixed-size parity space is used,
the transient profiles φk k−L+1 (k0) and the
k−Lk+1 (k0) = ϕk
k
random noises ξk−L+1 = ςk−L+1 (i.e., Σ = Σς ).
Let Pk0 (resp. P0 P∞) be the probability measure
when the residuals r1L, r2L+1, · · · , rkk−L+1, · · · follow the
statistical model (17), Ek0 (resp. E0 E∞) denote the
corresponding mathematical expectations, and pk0 (resp.
p0) stand for the probability density function.
In this paper, the Kullback-Leibler (K-L) distance is utilized
for comparing between residual-generation methods.
It is assumed, for the sake of simplicity, that k = L and
k0 = 1. Let us stack the vectors ψ1, ψ2, . . . , ψL (resp.
ϕ1, ϕ2, . . . , ϕL) into the concatenated vector ψ1L(1) (resp.
ϕ1L (1)). For the Gaussian noises, the K-L distances are
calculated as (see (Basseville and Nikiforov, 1993, p. 122))
ρKF = 1 ψ1L (1) T Σ−1 ψ1L (1) , (18)
2
ρP S = 21 ϕ1L (1) T Σς−1 ϕ1L (1) , (19)
where ρKF and ρP S are the K-L distances generated by the
steady-state Kalman filter and the fixed-size parity space
approaches, respectively.
Remark 5. It is well-known that the residuals with higher
K-L distance give better statistical performances than
the residuals with lower K-L distance (see Basseville and
Nikiforov (1993)). The numerical comparison between the
steady-state Kalman filter approach and the fixed-size
parity space approach will be given by simulation result
in section 6.
5. DETECTION ALGORITHMS
Based on unified statistical model (17), we design in
this section the VTWL CUSUM algorithm to detect the
transient changes. It will be shown that the optimal choice
of thresholds leads to the simple FMA detection rule.
5.1 VTWL CUSUM algorithm
For each time instant k ≥ L, the VTWL CUSUM algorithm
utilizes the last L measurements yk−L+1, · · · , yk
for decision making. The stopping time T of the VTWL
CUSUM algorithm is calculated as follows:
T = inf k ≥ L :
max
k−L+1≤i≤k
Sik − hk−i+1 ≥ 0 , (20)
where h1, h2, · · · , hL are chosen thresholds and Sik, for
each index i within the time window [k − L + 1, k], is
the log-likelihood ratio (LLR) between the probability
TmheaesLuLreRPSiikainsdcatlhceulaptreed-chinantghee Gpraoubsasbiailnitycasmeeaassure P0.
Sik = φkk−L+1 (i)
T
Σ−1
rkk−L+1 − 12 φkk−L+1 (i) . (21)
The operation of the VTWL CUSUM algorithm is as
follows. The LLR Sik, for each time index i from k−L+1 to
k, is first calculated by (21), where the vector of residuals
rkk−L+1, the vector of transient signals φkk−L+1 (i), and
inf
h1,h2,··· ,hL
subject to
the covariance matrix Σ of the random noises ξkk−L+1
can be calculated by either the steady-state Kalman filter
approach or the fixed-size parity space approach. Then,
the LLR Sik is compared to each threshold hk−i+1 and
the alarm time T is raised if one of the LLRs is greater
than or equal to its corresponding threshold. Especially,
the thresholds h1, h2, · · · , hL are considered as the tuning
parameters for optimizing the VTWL CUSUM algorithm.
5.2 FMA detection rule
The optimization of the VTWL CUSUM algorithm has
been considered in Gu´epi´e et al. (2012b); Gu´epi´e (2013)
for the independent normal observations. The main idea
is as follows. Firstly, the upper bound P˜md on the worstcase
probability of missed detection Pmd and the upper
bound P˜fa on the worst-case probability of false alarm
Pfa are calculated instead of their exact values. Secondly,
the thresholds h1, h2, · · · , hL are tuned for minimizing the
upper bound P˜md for a given value of the upper bound P˜fa.
It has been shown that the optimal choice of thresholds
corresponds to h1, · · · , hL−1 → +∞ and hL is chosen for
assuring an acceptable level of false alarms.
Fortunately, similar results are still valid in a more general
case of stochastic-dynamical systems. The main outcome
is given as the following
Theorem 1. Consider the VTWL CUSUM test defined in
(20)-(21). Then,
1) The optimal choice of the thresholds h1, h2, · · · , hL
leads to the following optimization problem:
˜
Pmd (hL)
Pfa (T ; mα; h1, h2, · · · , hL) ≤ α
where α is the acceptable level for the worst-case probability
of false alarm within any time window of length
mα. The optimization problem (22) has the unique solution
(h1∗, h2∗, · · · , h∗L) for a given α ∈ (0, 1), where
h1∗, h2∗, · · · , h∗L−1 → +∞ and h∗L is calculated from the
following equation:
P0
L+mα−1
Skk−L+1 < h∗L
= 1 − α.
(23)
= inf k ≥ L : φ1L (1)
k=L
2) The optimized VTWL CUSUM test is equivalent to the
following FMA test:
˜ T
T hL
˜
Σ−1rkk−L+1 ≥ hL , (24)
where the threshold h˜L of the FMA test (24) is related to
the optimal threshold h∗L of the optimized VTWL CUSUM
test (20) by
h˜L = h∗L + 1 φ1L (1) T Σ−1 φ1L (1) . (25)
2
Remark 6. It follows from the comparison between (20)
and (24) that the FMA test significantly reduces the computational
burden of the VTWL CUSUM test. Moreover,
theoretical results of Theorem 1 will be illustrated by
numerical examples to show that the FMA test performs
better than the WL CUSUM test (i.e., the VTWL CUSUM
test with equal thresholds h1 = · · · = hL), which is an
asymptotically optimal test for the classical non-Bayesian
change detection, introduced in Willsky and Jones (1976)
and studied in Lai (1995, 1998), in the next section.
,
(22)
750
SAFEPROCESS 2015
September 2-4, 2015. Paris, France
Van Long DO et al. / IFAC-PapersOnLine 48-21 (2015) 746-753
751
6. APPLICATION AND NUMERICAL EXAMPLES
In this section, the proposed and other conventional algorithms
are utilized for detecting cyber/physical attacks on
a simple SCADA water distribution network.
6.1 SCADA water distribution network
Let us consider a simple SCADA water distribution network
as shown in Fig. 1. The water network is comprised
of a treatment plant W1, a reservoir R1, a pump P1, 3
junctions N2, N3 and N4, 4 pipelines C01, C12, C23, and
C24 and 2 consumers d1 and d2. Two pressure sensors S1
and S2 are equipped for measuring pressure heads h1 at
the reservoir and h2 at the node N2, respectively.
The linearized model of the water network (in Fig. 1) can
be described in the discrete-time state space model (1),
where xk ∈ R is the pressure head h1 at the reservoir,
uk ∈ R is the control signals sent from the control center to
the local controller for regulating the flow rate Q01 through
the pump, dk ∈ R2 is the disturbances corresponding
to the consummation of customers at nodes N3 and N4,
yk ∈ R2 is the measurements of sensors S1 and S2. The
process noises wk ∼ N (0, Q) and the sensor noises vk ∼
N (0, R); the matrices A ∈ R1×1, B ∈ R1×1, F ∈ R1×2,
C ∈ R2×1, D ∈ R2×1, G ∈ R2×2, Q ∈ R1×1, and R ∈ R2×2
(corresponding to n = 1, m = 1, p = 2, q = 2).
Fig. 1. The simple SCADA water distribution network in
our case study.
For the demonstration purpose, let us consider an attack
scenario where the attacker performs coordinated attacks
by stealing water from the reservoir with a constant flow
rate Q0, turning off the pump P1 and compromising the
measurements of sensors S1 and S2 during the attack
period τa = [k0, k0 + L − 1], where k0 is the unknown
attack instant and L is the known attack duration. This
attack scenario is motivated by a real attack on city water
utility where the pump was burned out after being turned
on and off, as reported in Zetter (2011). As a result, the
attack vector ak ∈ R4 is designed by the adversary and the
matrices Ba ∈ R1×4 and Da ∈ R2×4 are decided by system
operators (corresponding to r = 2 and s = r + p = 4).
The simulation parameters are chosen as follows. The
sample time TS = 100s and the initial pressure head
x0 = 100m. The system matrices A = 1, B = 0.5, F =
751
1 0 0 0
[ −0.5 −0.5 ], C = 1 , D = 0 , G = −10 −10 . The
0 0 0 0
attack matrices Ba = [ 0.5 0.5 0 0 ] and Da = 0 0 0 1 .
The covariance matrices Q = 0.02 (and Q = 0.2) and
1 0
R = 0 1 . The stolen flow rate is Q0 = 0.2 m3/s. The
attack duration L = 8 observations, corresponding to a
period of 13.3min. The false alarm rate is measured by
the time window of length mα = 3L = 24 observations,
being equivalent to a duration of 40min. The attack vector
ak ∈ R4 is designed by the covert attack strategy, which
was first introduced in Smith (2011), as follows:
ak =
[0]

 −0.2 

 −1 
 0.6 (k − k0) 
 0.6 (k − k0)

[0]
if k < k0
if k0 ≤ k < k0 + L,
(26)
if k ≥ k0 + L
where [0] is the null vector.
Remark 7. The attack vector ak ∈ R4 contains all information
describing the model of the attack. The first
element reflects the physical attack to withdraw water
from the reservoir with the flow rate of Q0 = 0.2 m3/s.
The second element reflects the cyber attack on the control
signals for turning off the pump. The modification of the
sensor measurements by the covert attack strategy Smith
(2011) is described by the two last elements.
Remark 8. The idea of the covert attack is to coordinate
the state attack vector and the sensor attack vector for
realizing his malicious target while bypassing traditional
anomaly detectors. The sensor attack vector is designed
in such a way that it can compensate for the negative
impact (i.e., the change in the distribution of the residuals)
caused by the state attack vector. It has been shown
that the covert attack is completely stealthy to traditional
anomaly detectors if the attacker is able to compromise
all sensors. From the defender's point of view, this stealthy
attack needs to be rendered detectable before applying any
detection algorithm. In other words, reliable measurements
containing some information about the attack must be
transmitted successfully to the detection algorithm. For
the demonstration purpose, we propose in this numerical
example a simple countermeasure for rendering the covert
attack detectable. This method consists in protecting
sensor S1 so that its measurements can not be modified
by the attacker. This sensor protection scheme is reflected
in the matrix Da, where Da (1, 3) = 0 means that sensor
S1 is secure and Da (2, 4) = 1 signifies that sensor S2 is
vulnerable.
6.2 Numerical examples
The statistical performances of some detection rules by 106
Monte Carlo simulation are given in Fig. 2. The thresholds
are selected such that the worst-case probability Pfa of
all algorithms are almost the same for comparing the
probability of missed detection Pmd. For example, with
process noise variance Q = 0.2 (in Fig. 2b), the thresholds
h1 = · · · = hL of the WL CUSUM algorithm are chosen
SAFEPROCESS 2015
7S5e2ptember 2-4, 2015. Paris, France
Van Long DO et al. / IFAC-PapersOnLine 48-21 (2015) 746-753
10−2
10−3
18
17
16
15
14
13
12
10−1
10−2
10−3
10−4
10−1
10−2
10−3
10−3
10−2
10−1
(b) Process noise covariance matrix Q = 0.2
Fig. 2. Comparison between the steady-state Kalman
filter-based detectors (χ2, CUSUM, WL CUSUM and
FMA) and the fixed-size parity space-based detectors
(WL CUSUM and FMA).
from 3.0 to 7.9 and the thresholds h˜L of the FMA test are
selected from 15.9 to 24.2, for both steady-state Kalman
filter and fixed-size parity space approaches.
Following remarks can be drawn from the simulation
results. Firstly, the proposed algorithms perform much
better than the traditional non-parametric χ2 detector.
Secondly, given an acceptable level on the probability of
false alarm, the probability of missed detection of the
FMA tests is smaller than that of the WL CUSUM tests.
In other words, the simple FMA tests outperform the
WL CUSUM tests (for both the steady-state Kalman
filter approach and the fixed-size parity space approach).
Finally, the statistical performance of the Kalman filterbased
algorithms is better than that of the parity spacebased
tests, particularly with small process noises.
The comparison between the steady-state Kalman filter
approach and the fixed-size parity space approach is shown
in Fig. 3. It can be seen from Fig. 3a that the steady-state
Kalman filter approach outperforms the fixed-size parity
space approach, especially when the process noise is small.
This phenomenon is presented in Fig. 3b, where the KL
distances of the residuals generated by two approaches
are drawn as functions of the process noise variance. The
steady-state Kalman filter generates the residuals with
higher K-L distance than the residuals generated by the
fixed-sized parity space. The difference becomes significant
if the process noise is small. In contrast, when the process
10−3
10−2
10−1
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
(a) Process noise covariance matrix Q = 0.02
(a) Statistical performance of the FMA detectors.
752
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
(b) Kullback-Leibler distance.
Fig. 3. Comparison between the steady-state Kalman filter
approach and the fixed-size parity space approach for
different values of process noise covariance matrix Q.
noise is large, the difference is negligible. This phenomenon
is explained by the fact that the approximation of the
Bayesian approach, i.e., a steady-state Kalman filter, by
the minimax approach, i.e., by the fixed-size parity space
filter, produces a significant error only if the process noise
is small and, hence, the a priori information plays an
important role.
Moreover, the K-L distance of the residuals generated by
the least-square estimation method proposed by Gustafsson
(2002) coincides with the K-L distance of the residuals
generated by the fixed-size parity space. It can be
concluded that the least-square estimation method is as
efficient as the parity space approach in generating the
residuals for fault/attack detection and identification.
7. CONCLUSION
The sequential monitoring of SCADA systems against
cyber/physical attacks has been considered in this paper.
The main contributions of this paper are to develop the
unified statistical model of the residuals generated by either
the steady-state Kalman filter or the fixed-size parity
space, to design the VTWL CUSUM algorithm adapted to
the unified statistical model and to optimize the thresholds
w.r.t. the transient change detection criterion. It is
concluded from the simulation results that the steady-state
Kalman filter approach generates the residuals with higher
K-L distance, thus providing better statistical performance
than the fixed-size parity space approach, especially when
SAFEPROCESS 2015
September 2-4, 2015. Paris, France
Van Long DO et al. / IFAC-PapersOnLine 48-21 (2015) 746-753
753
the process noise is small. In addition, the proposed
FMA tests perform much better than the traditional χ2,
CUSUM, WL CUSUM tests (for both the steady-state
Kalman filter and the fixed-size parity space approaches)
with respect to the transient change detection criterion.
The attack profiles are assumed to be completely known
to simplify the theoretical analysis. The future work will
be focused on the scenarios, where the attack profiles are
(partially or completely) unknown. The sensibility analysis
of the proposed FMA test w.r.t. operational parameters
will be also considered.
ACKNOWLEDGEMENTS
This work was supported by the French National Research
Agency (ANR)-through ANR CSOSG Program (Project
ANR-11-SECU-0005).
REFERENCES
Amin, S., Litrico, X., Sastry, S., and Bayen, A. (2012a).
Cyber security of water scada systems:(i) analysis and
experimentation of stealthy deception attacks. IEEE
Transactions on Control Systems Technology, 20.
Amin, S., Litrico, X., Sastry, S., and Bayen, A. (2012b).
Cyber security of water scada systems:(ii) attack detection
using an enhanced hydrodynamic model. IEEE
Transactions on Control Systems Technology, 20.
Basseville, M. and Nikiforov, I. (1993). Detection of
abrupt changes: theory and application. Prentice Hall
Englewood Cliffs.
Brunner, M., Hofinger, H., Krauss, C., Roblee, C., Schoo,
P., and Todt, S. (2010). Infiltrating critical infrastructures
with next-generation attacks. Fraunhofer Institute
for Secure Information Technology (SIT), Munich.
C´ardenas, A.A., Amin, S., Lin, Z.S., Huang, Y.L., Huang,
C.Y., and Sastry, S. (2011). Attacks against process control
systems: risk assessment, detection, and response.
In Proceedings of the 6th ACM Symposium on Information,
Computer and Communications Security, 355-366.
Chen, J. and Patton, R.J. (1999). Robust model-based
fault diagnosis for dynamic systems. Kluwer academic
publishers.
Esary, J.D., Proschan, F., and Walkup, D.W. (1967). Association
of random variables, with applications. Ann.
Math. Statist., 38(5), 1466-1474.
Fouladirad, M., Freitag, L., and Nikiforov, I. (2008). Optimal
fault detection with nuisance parameters and a
general covariance matrix. International Journal of
Adaptive Control and Signal Processing, 22(5), 431-439.
Fouladirad, M. and Nikiforov, I. (2005). Optimal statistical
fault detection with nuisance parameters. Automatica,
41(7), 1157-1171.
Gorman, S. (2009). Electricity grid in us penetrated by
spies. Wall Street Journal, 8.
Gu´epi´e, B.K. (2013). D´etection s´equentielle de signaux
transitoires : application `a la surveillance d'un r´eseau
d'eau potable. Ph.D. thesis, Universit´e de Technologie
de Troyes.
Gu´epi´e, B.K., Fillatre, L., and Nikiforov, I. (2012a). Sequential
detection of transient changes. Sequential Analysis,
31(4), 528-547.
Gu´epi´e, B.K., Fillatre, L., and Nikiforov, I.V. (2012b).
Sequential monitoring of water distribution network. In
753
16th IFAC Symposium on System Identification, SYSID
2012, July 11-13, 392-397. Brussels, Belgium.
Gustafsson, F. (2002). Stochastic fault diagnosability in
parity spaces. In Proceedings of the 15th IFAC World
Congress, 736-736.
Kwon, C., Liu, W., and Hwang, I. (2013). Security analysis
for cyber-physical systems against stealthy deception
attacks. In American Control Conference (ACC), 2013,
3344-3349.
Lai, T.L. (1995). Sequential changepoint detection in
quality control and dynamical systems. Journal of
the Royal Statistical Society. Series B (Methodological),
613-658.
Lai, T.L. (1998). Information bounds and quick detection
of parameter changes in stochastic systems. Information
Theory, IEEE Transactions on, 44(7), 2917-2929.
Lai, T.L. (2001). Sequential analysis: some classical
problems and new challenges. Statistica Sinica, 11(2),
303-350.
Lai, T.L. and Shan, J.Z. (1999). Efficient recursive algorithms
for detection of abrupt changes in signals and
control systems. Automatic Control, IEEE Transactions
on, 44(5), 952-966.
Lehmann, E.L. (1966). Some concepts of dependence. The
Annals of Mathematical Statistics, 37(5), 1137-1153.
Mo, Y., Garone, E., Casavola, A., and Sinopoli, B. (2010).
False data injection attacks against state estimation
in wireless sensor networks. In Decision and Control
(CDC), 2010 49th IEEE Conference on, 5967-5972.
Mo, Y. and Sinopoli, B. (2009). Secure control against
replay attacks. In Communication, Control, and Computing,
2009. Allerton 2009. 47th Annual Allerton Conference
on, 911-918.
Mo, Y. and Sinopoli, B. (2010). False data injection
attacks in control systems. In Preprints of the 1st
Workshop on Secure Control Systems.
Pasqualetti, F., Dorfler, F., and Bullo, F. (2013). Attack
detection and identification in cyber-physical systems.
IEEE Transactions on Automatic Control,
58(11), 2715-2729.
Poor, H. and Hadjiliadis, O. (2009). Quickest Detection.
Cambridge, University Press.
Slay, J. and Miller, M. (2007). Lessons learned from
the maroochy water breach. Critical Infrastructure
Protection, 73-82.
Smith, R.S. (2011). A decoupled feedback structure for
covertly appropriating networked control systems. Proc.
IFAC World Congress, 90-95.
Tartakovsky, A., Nikiforov, I., and Basseville, M. (2014).
Sequential Analysis : Hypothesis Testing and Changepoint
Detection. CRC Press, Taylor & Francis Group.
Teixeira, A., Shames, I., Sandberg, H., and Johansson,
K.H. (2012). Revealing stealthy attacks in control
systems. In Communication, Control, and Computing
(Allerton), 2012 50th Annual Allerton Conference on,
1806-1813.
Willsky, A. and Jones, H. (1976). A generalized likelihood
ratio approach to the detection and estimation of jumps
in linear systems. Automatic Control, IEEE Transactions
on, 21(1), 108-112.
Zetter, K. (2011). Attack on city water station destroys
pump. online.